@if (recipe; as r) {
<section class="container py-4">
  <div class="row g-4">
    <div class="col-12 col-lg-6">
      <img
        [src]="r.imageUrl"
        [alt]="r.title"
        class="img-fluid rounded shadow"
      />
    </div>
    <div class="col-12 col-lg-6">
      <p class="text-uppercase text-warning small mb-2">{{ r.category }}</p>
      <h2 class="fw-bold text-primary">{{ r.title }}</h2>
      <p class="text-muted">{{ r.description }}</p>
      <div class="d-flex flex-wrap gap-3 my-3 text-muted">
        <span>Durée : {{ r.durationMinutes }} min</span>
        <span>Difficulté : {{ r.difficulty | titlecase }}</span>
        <span>Note : ★ {{ r.rating | number : "1.1-1" }}</span>
      </div>
      <div class="d-flex gap-2 flex-wrap">
        <button class="btn btn-warning text-dark" (click)="toggleFavorite()">
          {{ r.isFavorite ? "Retirer des favoris" : "Ajouter aux favoris" }}
        </button>
        <div class="btn-group" role="group" aria-label="Noter la recette">
          @for (rate of [3, 4, 5]; track rate) {
          <button class="btn btn-outline-primary" (click)="rateRecipe(rate)">
            {{ rate }} ★
          </button>
          }
        </div>
      </div>
    </div>
  </div>

  <div class="row mt-5 g-4">
    <div class="col-12 col-lg-4">
      <div class="card shadow-sm">
        <div class="card-body">
          <h5 class="card-title">Ingrédients</h5>
          <ul class="list-group list-group-flush">
            @for (ingredient of r.ingredients; track ingredient.name) {
            <li class="list-group-item">
              {{ ingredient.name }} - {{ ingredient.quantity }}
              {{ ingredient.unit }}
            </li>
            }
          </ul>
        </div>
      </div>
    </div>
    <div class="col-12 col-lg-8">
      <div class="card shadow-sm mb-4">
        <div class="card-body">
          <h5 class="card-title">Étapes</h5>
          <ol class="ps-3">
            @for (step of r.steps; track $index) {
            <li class="mb-2">{{ step }}</li>
            }
          </ol>
        </div>
      </div>
      @if (isAuthenticated) {
      <app-comment-form
        [recipeId]="r.id"
        (commentCreated)="onCommentCreated($event)"
      ></app-comment-form>
      } @else {
      <div class="alert alert-info">
        Connecte-toi pour laisser un commentaire.
      </div>
      }
      <app-comment-list [comments]="comments"></app-comment-list>
    </div>
  </div>
</section>
} @else { @if (loading) {
<app-loading-spinner></app-loading-spinner>
} @if (error) {
<div class="container">
  <div class="alert alert-danger mt-4">{{ error }}</div>
</div>
} }
